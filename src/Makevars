PKG_LIBS = `pkg-config --libs grpc++` -Lrserve-client -lrserve-client

$(SHLIB): client.o server.o rserve-client/librserve-client.a

%.o: %.cpp
	@echo "Building gRPCr object files"
	$(CC) -I"/usr/include/R/" $(CXXFLAGS) $(CXXPICFLAGS) -c $< -o $@

rserve-client/librserve-client.a:
	@echo "Building rserve-client library"
	@(cd rserve-client && $(MAKE) librserve-client.a \
	  CC="$(CC)" CFLAGS="$(CFLAGS) $(CPICFLAGS)" AR="$(AR)")
